---
phase: 3
plan: 1
wave: 1
---

# Plan 3.1: Python WebSocket Server & Vector Matching

## Objective
Establish the core connection between the central PC Hub and the IoT Glove and implement 7D vector-space gesture recognition.

## Context
- .gsd/SPEC.md
- .gsd/ROADMAP.md

## Tasks

<task type="auto">
  <name>Build Hub WebSocket Server and Reference Library</name>
  <files>
    hub/main_server.py
    hub/utils/gesture_library.json
  </files>
  <action>
    - Create `gesture_library.json` establishing baseline 7D vectors for 5 critical phrases: "Help", "Question", "Yes", "No", "I am Miran". The vectors should look similar to `<F1..5, GX, GY>` (Heart rate is omitted from the matching vector as it is reserved for affective resonance logic). Example: "help": [300, 800, 300, 300, 300, 0.0, 0.0].
    - Create `hub/main_server.py`. It should:
      - Start a long-running WebSocket client to connect to `ws://localhost:81` (the Mock/ESP8266 stream).
      - Continuously parse the incoming `<F1,F2,F3,F4,F5,GX,GY,HR>` strings.
  </action>
  <verify>python -m py_compile hub/main_server.py</verify>
  <done>Python client successfully connects to port 81 and correctly parses out the 7D array and the separate HR integer.</done>
</task>

<task type="auto">
  <name>Implement Vector-Space Recognition Engine</name>
  <files>hub/services/gesture_engine.py</files>
  <action>
    - Create a cosine similarity function.
    - Export a function `match_gesture(incoming_vector, library_vectors)` that iterates over the defined library and returns the string intent (e.g., "question") if it exceeds a similarity threshold (e.g., `0.95`).
    - Integrate it into `main_server.py` so that every 0.5s or so (to prevent spamming), it attempts a match. If a match occurs, print `[Match]: "question"` to the console.
  </action>
  <verify>python -m py_compile hub/services/gesture_engine.py</verify>
  <done>Cosine similarity accurately maps incoming vectors against the JSON library without throwing exceptions.</done>
</task>

## Success Criteria
- [ ] PC Hub can connect to the glove WebSocket server.
- [ ] Raw glove vectors are successfully identified as structured intents (like "question").
